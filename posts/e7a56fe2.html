<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>(自动化部署，CI/CD) 多环境多平台安装并使用 Jenkins | Sora33</title><meta name="author" content="Sora33"><meta name="copyright" content="Sora33"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="前言CI&#x2F;CD 是持续化继承和持续化部署的简称。目的是在开发的过程中，尽可能的降低人工成本，来完成部署操作。通过 Jenkins 自动流水线工作可以省去很多时间，对于程序开发者而言，将部署 jar 包、修改环境、日志记录等一系列操作集成到 Jenkins 任务内，省时又省力，本次将以 Jenkins 为核心进行从 0 到 1 的搭建与使用，并提供了 Java 单体项目与微服务的通用 shell 脚">
<meta property="og:type" content="article">
<meta property="og:title" content="(自动化部署，CI&#x2F;CD) 多环境多平台安装并使用 Jenkins">
<meta property="og:url" content="http://33sora.com/posts/e7a56fe2.html">
<meta property="og:site_name" content="Sora33">
<meta property="og:description" content="前言CI&#x2F;CD 是持续化继承和持续化部署的简称。目的是在开发的过程中，尽可能的降低人工成本，来完成部署操作。通过 Jenkins 自动流水线工作可以省去很多时间，对于程序开发者而言，将部署 jar 包、修改环境、日志记录等一系列操作集成到 Jenkins 任务内，省时又省力，本次将以 Jenkins 为核心进行从 0 到 1 的搭建与使用，并提供了 Java 单体项目与微服务的通用 shell 脚">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://minaseinori.oss-cn-hongkong.aliyuncs.com/blog/0401/wallhaven-3l3ed3_3840x2160.png">
<meta property="article:published_time" content="2024-03-11T01:19:12.000Z">
<meta property="article:modified_time" content="2024-11-26T02:36:45.194Z">
<meta property="article:author" content="Sora33">
<meta property="article:tag" content="jenkis">
<meta property="article:tag" content="DevOps">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://minaseinori.oss-cn-hongkong.aliyuncs.com/blog/0401/wallhaven-3l3ed3_3840x2160.png"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="http://33sora.com/posts/e7a56fe2.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          const mediaQueryDark = window.matchMedia('(prefers-color-scheme: dark)')
          const mediaQueryLight = window.matchMedia('(prefers-color-scheme: light)')
          
          if (theme === undefined) {
            if (mediaQueryLight.matches) activateLightMode()
            else if (mediaQueryDark.matches) activateDarkMode()
            else {
              const hour = new Date().getHours()
              const isNight = hour <= 8 || hour >= 19
              isNight ? activateDarkMode() : activateLightMode()
            }
            mediaQueryDark.addEventListener('change', () => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else {
            theme === 'light' ? activateLightMode() : activateDarkMode()
          }
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: {"appId":"1QY6GKFJYT","apiKey":"ff7af72210f9015cb3c5205c3a3824e2","indexName":"dev_home","hitsPerPage":6,"languages":{"input_placeholder":"搜索文章","hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，耗时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":500,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '(自动化部署，CI/CD) 多环境多平台安装并使用 Jenkins',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  isShuoshuo: false
}</script><link rel="stylesheet" href="/css/rightMenu.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="pokeball-loading"><div class="pokeball" id="normal"></div><div class="pokeball" id="great"></div><div class="pokeball" id="ultra"></div><div class="pokeball" id="master"></div><div class="pokeball" id="safari"></div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = 'auto'
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load', preloader.endLoading)

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="web_bg" style="background-image: url(https://minaseinori.oss-cn-hongkong.aliyuncs.com/blog/0817/wallhaven-g7mpj7_1920x1080.png);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/blog/nayuta.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">61</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">65</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-calendar"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-wheelchair-alt"></i><span> 关于我</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://minaseinori.oss-cn-hongkong.aliyuncs.com/blog/0401/wallhaven-3l3ed3_3840x2160.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/blog/nayuta.jpg" alt="Logo"><span class="site-name">Sora33</span></a><a class="nav-page-title" href="/"><span class="site-name">(自动化部署，CI/CD) 多环境多平台安装并使用 Jenkins</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-calendar"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-wheelchair-alt"></i><span> 关于我</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">(自动化部署，CI/CD) 多环境多平台安装并使用 Jenkins</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2024-03-11T01:19:12.000Z" title="发表于 2024-03-11 09:19:12">2024-03-11</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%99%E7%A8%8B/">教程</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">3.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>12分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><div id="post-outdate-notice" data="{&quot;limitDay&quot;:300,&quot;messagePrev&quot;:&quot;距离最后更新已经过了&quot;,&quot;messageNext&quot;:&quot;天，文章内容可能已过时，如果有问题，欢迎留言反馈&quot;,&quot;postUpdate&quot;:&quot;2024-11-26 10:36:45&quot;}" hidden></div><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>CI/CD 是持续化继承和持续化部署的简称。目的是在开发的过程中，尽可能的降低人工成本，来完成部署操作。通过 Jenkins 自动流水线工作可以省去很多时间，对于程序开发者而言，将部署 jar 包、修改环境、日志记录等一系列操作集成到 Jenkins 任务内，省时又省力，本次将以 Jenkins 为核心进行从 0 到 1 的搭建与使用，并提供了 Java 单体项目与微服务的通用 shell 脚本供于使用。</p>
<h2 id="环境说明"><a href="#环境说明" class="headerlink" title="环境说明"></a>环境说明</h2><p>本文通过两种方式进行演示，第一种是基于 Docker 完成 Jenkins 的安装与应用，Docker 使用版本为 25.0.3；第二种是直接在本机上安装 Jenkins（本人主机为 Mac，所以使用 Mac 来安装，Linux 基本也是一样的）</p>
<p>基于 Docker 的 Jenkins 更多适合训练，因为所有的操作都在容器内、方便后续转移以及迁移。但缺点是 Jenkins 与宿主机的环境不互通，如在容器打完的 jar 包只能放在挂载的目录里。而且 Java 项目需要连接的中间件也非常多、且因为 jar 包是跑在 Jenkins 容器内的，所以配置容器间通信又是一个复杂点。（推荐初上手的同学使用，先用 docker 搭建一个完成的任务进行测试）</p>
<p>而直接部署在本机上更适合生产环境，更加的灵活方便，shell 脚本的操作空间更大，并且可以直接访问各种中间件，省去了容器间通信的配置调试时间</p>
<h2 id="安装Jenkins（Docker）"><a href="#安装Jenkins（Docker）" class="headerlink" title="安装Jenkins（Docker）"></a>安装 Jenkins（Docker）</h2><p>基于 Docker 安装 Jenkins 大致分为拉取镜像与脚本编辑</p>
<h3 id="拉取镜像"><a href="#拉取镜像" class="headerlink" title="拉取镜像"></a>拉取镜像</h3><p>这里拉取镜像的时候我推荐直接去官网指定版本下载，我一开始通过后缀跟 latest 下载最新版导致很多插件都下不下来。最后去官网指定了一个版本才行 <a target="_blank" rel="noopener" href="https://hub.docker.com/r/jenkins/jenkins/tags">Jenkins-Docker 镜像官网</a></p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">修改前</span></span><br><span class="line">docker pull jenkins/jenkins:latest</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">修改后(因为我本地开发环境用的是17，所以直接下载了一个内置17的jenkins，当然也可以不指定，后通过jenkins内部下载对应的Java版本，不过还是更推荐前者，而且在内部下载Java也比较麻烦。本文以前者进行！！)</span></span><br><span class="line">docker pull jenkins/jenkins:2.448-jdk17</span><br></pre></td></tr></tbody></table></figure>

<h3 id="编写安装脚本"><a href="#编写安装脚本" class="headerlink" title="编写安装脚本"></a>编写安装脚本</h3><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim startJenkins.sh</span><br></pre></td></tr></tbody></table></figure>

<p>这里简单介绍一下每个参数，其中 **-u** 需要特别注意！</p>
<blockquote>
<p>-d：后台运行</p>
<p>-p：将容器的 8080 端口映射到宿主机的 8081 端口上</p>
<p>-u：使用 UID 为 0 的用户身份运行 Jenkins 容器（这里如果不指定 - u 后面如果想要通过 jenkins 操作 SHELL 脚本会导致没有权限，所以需要使用 root 的身份运行容器）</p>
<p>一般情况下 0 为管理员角色，也可以使用 <strong>id 0</strong> 来检测是否是 root 用户</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/%E6%95%99%E5%AD%A6%E7%9B%AE%E5%BD%95/202403111558233.png" alt="image-20240311155842435"></p>
<p>-v：挂载目录，将 jenkins 的工作目录挂在到宿主机内，这样使用 jenkins 操作目录时，我们本地也会有相同的反馈</p>
<p>–restart：在容器退出时自动重启容器</p>
<p>–name：配置容器名字</p>
</blockquote>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">-p 8081:8080 \</span><br><span class="line">-u 0 \</span><br><span class="line">-v /Users/sora33/docker/jenkins/data:/var/jenkins_home \</span><br><span class="line">--restart=always \</span><br><span class="line">--name jenkins \</span><br><span class="line">jenkins/jenkins:2.448-jdk17</span><br></pre></td></tr></tbody></table></figure>

<p>创建完成后，使用 chmod -R 赋值脚本权限并执行</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 赋值权限</span></span><br><span class="line"><span class="built_in">chmod</span> -R 755 startJenkins.sh</span><br><span class="line"><span class="comment"># 执行脚本</span></span><br><span class="line">./startJenkins.sh</span><br></pre></td></tr></tbody></table></figure>

<p>输入 <code>IP:8081</code> 进入 Jenkins 主页面，首次进入页面会要求我们输入密码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/%E6%95%99%E5%AD%A6%E7%9B%AE%E5%BD%95/202403111622176.png" alt="image-20240311162221114"></p>
<p>密码会在容器内部打印出来</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">docker logs 容器名</span></span><br><span class="line">docker logs jenkins</span><br></pre></td></tr></tbody></table></figure>

<p>将密码复制并进入下一级页面</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/%E6%95%99%E5%AD%A6%E7%9B%AE%E5%BD%95/202403111623497.png" alt="image-20240311162328443"></p>
<h2 id="安装Jenkins（非Docker）"><a href="#安装Jenkins（非Docker）" class="headerlink" title="安装Jenkins（非Docker）"></a>安装 Jenkins（非 Docker）</h2><h3 id="Mac平台："><a href="#Mac平台：" class="headerlink" title="Mac平台："></a>Mac 平台：</h3><p><strong>使用 homebrew 安装 Jenkins，如未安装 homebrew 请先安装 homebrew！！！</strong></p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">安装jenkins</span></span><br><span class="line">brew install jenkins</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">注意，mac端安装完成后最后去/opt/homebrew/Cellar/jenkins/2.448/bin目录下看一下jenkins的环境变量是否正确！这里注意替换版本号！该目录下有jenkins</span></span><br><span class="line">sudo vim jenkins</span><br></pre></td></tr></tbody></table></figure>

<p>如果 JAVA_HOME 不是如图完整的路径而是 <code>@@HOMEBREW……</code> 什么的请使用下面命令重新安装</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew reinstall jenkins</span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/%E6%95%99%E5%AD%A6%E7%9B%AE%E5%BD%95/202403130956537.png" alt="image-20240313095649414"></p>
<p>之后去 <code>/opt/homebrew/Cellar/jenkins/2.448</code> 目录下修改局域网连接与端口号，默认只允许本机连接，改为 <code>0.0.0.0</code> 所有人可连接，下面端口号默认是 8080，这里我改为了 8081</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/%E6%95%99%E5%AD%A6%E7%9B%AE%E5%BD%95/202403130959320.png" alt="image-20240313095949249"></p>
<p>修改完成后，我们需要重启 Jenkins</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew services restart jenkins</span><br></pre></td></tr></tbody></table></figure>

<h3 id="Linux平台："><a href="#Linux平台：" class="headerlink" title="Linux平台："></a>Linux 平台：</h3><p><strong>Linux 平台本人暂时未实践，不过只要成功安装 Jenkins 就没问题，区别在于文件的存放路径位置的不同，配置本质是一样的</strong></p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo wget -O /etc/yum.repos.d/jenkins.repo http://pkg.jenkins-ci.org/redhat/jenkins.repo</span><br><span class="line">sudo rpm --import https://jenkins-ci.org/redhat/jenkins-ci.org.key</span><br><span class="line">sudo yum install jenkins</span><br></pre></td></tr></tbody></table></figure>

<p>这里放出 Linux 下的 Jenkins 默认目录</p>
<blockquote>
<p>/usr/lib/jenkins/：jenkins 安装目录</p>
<p>/etc/sysconfig/jenkins：Jenkins 配置文件目录</p>
<p>/var/lib/jenkins/：工作目录</p>
<p>/var/log/jenkins/jenkins.log：日志等</p>
</blockquote>
<h2 id="Jenkins配置"><a href="#Jenkins配置" class="headerlink" title="Jenkins配置"></a>Jenkins 配置</h2><p>输入 <code>127.0.0.1:8081</code> 进入 Jenkins 主页面，按照提示去对应目录拿到密码，下面我们需要安装常用的插件</p>
<h3 id="安装插件"><a href="#安装插件" class="headerlink" title="安装插件"></a>安装插件</h3><p>进入到该页面后，我们选择<code>安装推荐的插件</code></p>
<blockquote>
<p>PS：这里每个人的网络环境都不同，所以有可能导致一些插件无法正确下载下来</p>
<p>可以尝试改为清华大学的下载站，具体方法是进入刚刚我们挂载的工作目录内，也就是刚刚启动脚本 - v 所指定的目录，找到 <strong>hudson.model.UpdateCenter.xml</strong> 文件。将里面的 url 改为 <strong><a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json">https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json</a></strong> </p>
<p><strong>非 Docker 端可以先不配置镜像，一会直接通过页面配置</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/%E6%95%99%E5%AD%A6%E7%9B%AE%E5%BD%95/202403111628481.png" alt="image-20240311162849418"></p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/%E6%95%99%E5%AD%A6%E7%9B%AE%E5%BD%95/202403111625799.png" alt="image-20240311162519763"></p>
<h3 id="创建用户"><a href="#创建用户" class="headerlink" title="创建用户"></a>创建用户</h3><p>这个账号相当于管理员账户，创建完成后后面 URL 一般也不需要改动</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/%E6%95%99%E5%AD%A6%E7%9B%AE%E5%BD%95/202403111637878.png" alt="image-20240311163706839"></p>
<p>下面是配置 Java 与 Maven，我们需要用到 <strong>tools</strong> 和 <strong>plugins</strong> 这两个模块</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/%E6%95%99%E5%AD%A6%E7%9B%AE%E5%BD%95/202403111638850.png" alt="image-20240311163854811"></p>
<h3 id="配置Maven"><a href="#配置Maven" class="headerlink" title="配置Maven"></a>配置 Maven</h3><p>首先点击 <code>plugins</code>，继续点击 <code>Available plugins</code>，输入 <code>maven</code>，下载 <code>Maven Integration</code>，安装完成后我们</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/%E6%95%99%E5%AD%A6%E7%9B%AE%E5%BD%95/202403111640159.png" alt="image-20240311164026093"></p>
<p>接着我们回到管理页面点击 <code>tools</code></p>
<h4 id="Docker版配置"><a href="#Docker版配置" class="headerlink" title="Docker版配置"></a>Docker 版配置</h4><p>如果是 Docker 安装的话，我们直接在 Jenkins 容器内新装一个 maven。翻到最底下找到 Maven，新增 Maven，输入 Maven 的名字和版本，选择版本最好跟本地一致，然后点击保存</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/%E6%95%99%E5%AD%A6%E7%9B%AE%E5%BD%95/202403111645886.png" alt="image-20240311164542834"></p>
<h4 id="Linux与Mac配置"><a href="#Linux与Mac配置" class="headerlink" title="Linux与Mac配置"></a>Linux 与 Mac 配置</h4><p>一般 mac 与 linux 本机都已经安装完成 maven 了，如果没有安装请自行安装；安装完成后配置一下别名和路径即可</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/%E6%95%99%E5%AD%A6%E7%9B%AE%E5%BD%95/202403131008516.png" alt="image-20240313100833460"></p>
<p>之后翻到最顶上，配置一下使用的 maven 配置文件，路径为 setting.xml 的地址，这样就可以使用本地的仓库</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/%E6%95%99%E5%AD%A6%E7%9B%AE%E5%BD%95/202403131009829.png" alt="image-20240313100928792"></p>
<h3 id="配置Java"><a href="#配置Java" class="headerlink" title="配置Java"></a>配置 Java</h3><h4 id="Docker版配置-1"><a href="#Docker版配置-1" class="headerlink" title="Docker版配置"></a>Docker 版配置</h4><p>在同一个页面找到 JDK 安装部分，因为我下载的 jenkins 内置 jdk17，所以直接进入 jenkins 容器内查看 Java 所在的目录</p>
<blockquote>
<p>进入容器可以使用：docker exec -it c7c（容器 id 前 3 位） bash</p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/%E6%95%99%E5%AD%A6%E7%9B%AE%E5%BD%95/202403111656940.png" alt="image-20240311165659880"></p>
<p>配置别名，将路径输入，取消自动安装安装，点击保存</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/%E6%95%99%E5%AD%A6%E7%9B%AE%E5%BD%95/202403111657110.png" alt="image-20240311165748076"></p>
<h4 id="Linux与Mac配置-1"><a href="#Linux与Mac配置-1" class="headerlink" title="Linux与Mac配置"></a>Linux 与 Mac 配置</h4><p>在同一个页面找到 JDK 安装部分，与 maven 一样，我们本机大概率是已经安装好 Java 的，同样只需配置一下别名和路径</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/%E6%95%99%E5%AD%A6%E7%9B%AE%E5%BD%95/202403131010513.png" alt="image-20240313101056470"></p>
<h3 id="页面上配置Jenkins下载源"><a href="#页面上配置Jenkins下载源" class="headerlink" title="页面上配置Jenkins下载源"></a>页面上配置 Jenkins 下载源</h3><p>除了通过该文件，我们也可以在插件管理中直接配置</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json</span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/%E6%95%99%E5%AD%A6%E7%9B%AE%E5%BD%95/202403131347682.png" alt="image-20240313134732638"></p>
<h3 id="Jenkins的主目录"><a href="#Jenkins的主目录" class="headerlink" title="Jenkins的主目录"></a>Jenkins 的主目录</h3><p>jenkins 的工作目录可以在系统管理下的 system 中看到，默认是在用户目录下的.jenkins 文件夹内，我们项目的缓存、打包文件都在该目录下的 workspace 内。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/%E6%95%99%E5%AD%A6%E7%9B%AE%E5%BD%95/202411261035297.png" alt="image-20241126103521168"></p>
<h2 id="Jenkins使用"><a href="#Jenkins使用" class="headerlink" title="Jenkins使用"></a>Jenkins 使用</h2><h3 id="Maven项目自动化构建"><a href="#Maven项目自动化构建" class="headerlink" title="Maven项目自动化构建"></a>Maven 项目自动化构建</h3><ol>
<li><p>在主页面点击新建任务，选择<strong>构建一个 maven 项目</strong>，输入任务名称<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/%E6%95%99%E5%AD%A6%E7%9B%AE%E5%BD%95/202403120913866.png" alt="image-20240312091326780"></p>
</li>
<li><p>下面我们输入这个任务的描述、最好选择丢弃旧的构建，在下面选择对应的策略，这里我选择的是只保留最近的 3 次构建，方便发生意外后直接回滚</p>
</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/%E6%95%99%E5%AD%A6%E7%9B%AE%E5%BD%95/202403120916310.png" alt="image-20240312091601261"></p>
<ol start="3">
<li><p>下面我们来配置项目的 Git 地址，首先需要添加一个 Git 用户</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/%E6%95%99%E5%AD%A6%E7%9B%AE%E5%BD%95/202403120918889.png" alt="image-20240312091844841"></p>
</li>
</ol>
<p>以 GitHub 举例，像这样添加一个用户，用户名和密码就是你登陆 GitHub 的账号和密码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/%E6%95%99%E5%AD%A6%E7%9B%AE%E5%BD%95/202403120920226.png" alt="image-20240312092050180"></p>
<p>继续输入我们的 Git 地址以及所需要构建的分支</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/%E6%95%99%E5%AD%A6%E7%9B%AE%E5%BD%95/202403120944943.png" alt="image-20240312094410900"></p>
<ol start="4">
<li><p>下面是构建的参数，这里的意思为执行 clean package，清除再打包，跳过 test 阶段</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/%E6%95%99%E5%AD%A6%E7%9B%AE%E5%BD%95/202403120950968.png" alt="image-20240312095013918"></p>
</li>
<li><p>最后需要配置构建完成后的操作，一般是通过执行 shell 脚本，将刚刚构建完成的项目跑起来并记录日志</p>
</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/%E6%95%99%E5%AD%A6%E7%9B%AE%E5%BD%95/202403121336229.png" alt="image-20240312133619142"></p>
<ol start="6">
<li>脚本完成后我们点击保存并进行手动构建，尝试执行一次</li>
</ol>
<h3 id="boot项目通用shell脚本"><a href="#boot项目通用shell脚本" class="headerlink" title="boot项目通用shell脚本"></a>boot 项目通用 shell 脚本</h3><p>boot 脚本需要配置如下 5 个地方，通过序号对应</p>
<blockquote>
<p>1：<strong>LOG_DIR 与 LOG_FILE</strong>，前者为日志所需要存储的路径，后者为日志文件名</p>
<p>3：将 <strong>buildSoraProject</strong> 改为 jenkins 的任务名称，这里我的任务名称即为 <strong>buildSoraProject</strong></p>
<p>4：配置 jar 包的名字，如果不知道 jar 包的名字，可以通过进入容器内该路径查看，或者直接在 pom 文件的 build 标签内提前指定好</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/%E6%95%99%E5%AD%A6%E7%9B%AE%E5%BD%95/202403121343873.png" alt="image-20240312134300799"></p>
<p>6：配置 buildId，只要唯一即可，一般为任务名称</p>
<p>7：目前只配置了字符集与时间，可以根据需求自己追加，例如常用的 - Dspring.profiles.active=test</p>
</blockquote>
<p><strong>shell 脚本：</strong></p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1.定义日志目录和日志文件的路径</span></span><br><span class="line">LOG_DIR="$JENKINS_HOME/projectLog/buildSoraProject"</span><br><span class="line">LOG_FILE="$LOG_DIR/sora_project_log.log"</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2.确保日志目录存在，如果不存在则创建</span></span><br><span class="line">mkdir -p $LOG_DIR</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">3.进入 Jenkins 的 workspace 目录下的 buildSoraProject/target 文件夹</span></span><br><span class="line">cd $JENKINS_HOME/workspace/buildSoraProject/target</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">4.配置 jar包名称 sora33-0.0.1-SNAPSHOT.jar</span></span><br><span class="line">JAR_FILE=sora33-project.jar</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">5.尝试停止已运行的 JAR 文件进程</span></span><br><span class="line">PID=$(ps -ef | grep $JAR_FILE | awk '{print $2}')</span><br><span class="line">if [ ! -z "$PID" ]; then</span><br><span class="line">  echo "Stopping existing Java process: $PID"</span><br><span class="line">  kill -9 $PID</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">6.分配打包<span class="built_in">id</span></span></span><br><span class="line">BUILD_ID=buildSoraProject</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">7.执行 jar 包 将日志输出到之前定义的日志文件中 如果时间异常再追加GMT+8，第一次可以先注释</span></span><br><span class="line">nohup java -Dfile.encoding=UTF-8 \</span><br><span class="line">		-Duser.timezone=GMT+08 \</span><br><span class="line">     -jar $JAR_FILE &gt; $LOG_FILE 2&gt;&amp;1 &amp;</span><br><span class="line"></span><br><span class="line">echo "Application is running, and logs are being written to $LOG_FILE"</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<h3 id="cloud项目通用shell脚本"><a href="#cloud项目通用shell脚本" class="headerlink" title="cloud项目通用shell脚本"></a>cloud 项目通用 shell 脚本</h3><p>cloud 脚本需要配置如下 4 个地方，通过序号对应</p>
<blockquote>
<p>1：<strong>LOG_DIR_BASE</strong> 配置日志的路径，这里我放在 Jenkins 的工作目录下的 <code>projectLog</code> 文件夹里</p>
<p>2：打包 id，这里请务必将打包 id 与任务名称对应上，因为 Jenkins 会把该任务的结果输出在任务名称下的文件夹里</p>
<p>3：服务列表定义，这里需要配置项目所有的启动类，如下图是我的项目结构，可以参考 shell 脚本的格式对应你自己的项目结构</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/%E6%95%99%E5%AD%A6%E7%9B%AE%E5%BD%95/202403131122835.png" alt="image-20240313112208745" style="zoom:50%;">

<p>6：配置 Java 模块的启动命令，目前只配置了字符集与时间，可以根据需求自己追加，例如常用的 - Dspring.profiles.active=test</p>
</blockquote>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1.定义日志目录的基本路径</span></span><br><span class="line">LOG_DIR_BASE="$JENKINS_HOME/projectLog"</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2. 打包<span class="built_in">id</span></span></span><br><span class="line">BUILD_ID=sora</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">3.服务列表定义</span></span><br><span class="line">SERVICES=("sora-gateway" "sora-auth" "sora-modules/sora-user/user-server" "sora-modules/sora-system/system-server" "sora-modules/sora-system/spider-server")</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">4.停止所有服务</span></span><br><span class="line">for SERVICE in ${SERVICES[@]}; do</span><br><span class="line">  JAR_FILE=$(find $JENKINS_HOME/workspace/$BUILD_ID/$SERVICE/target -name "*.jar" -print -quit) # 假设每个服务目录下只有一个jar包</span><br><span class="line">  if [[ ! -z "$JAR_FILE" ]]; then</span><br><span class="line">    PID=$(ps -ef | grep $JAR_FILE | grep -v grep | awk '{print $2}')</span><br><span class="line">    if [[ ! -z "$PID" ]]; then</span><br><span class="line">      echo "Stopping $SERVICE (PID: $PID)"</span><br><span class="line">      kill -9 $PID</span><br><span class="line">    fi</span><br><span class="line">  fi</span><br><span class="line">done</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">5.启动所有服务</span></span><br><span class="line">for SERVICE in ${SERVICES[@]}; do</span><br><span class="line">  JAR_FILE=$(find $JENKINS_HOME/workspace/$BUILD_ID/$SERVICE/target -name "*.jar" -print -quit) # 假设每个服务目录下只有一个jar包</span><br><span class="line">  if [[ ! -z "$JAR_FILE" ]]; then</span><br><span class="line">    # 为每个服务创建一个专门的日志目录</span><br><span class="line">    LOG_DIR="$LOG_DIR_BASE/$(basename $SERVICE)"</span><br><span class="line">    mkdir -p $LOG_DIR</span><br><span class="line">    LOG_FILE="$LOG_DIR/$(basename $SERVICE)_log.log"</span><br><span class="line">    </span><br><span class="line">    # 6.Java启动命令行配置 </span><br><span class="line">  nohup java -Dfile.encoding=UTF-8 -Duser.timezone=GMT+08 \</span><br><span class="line">    -jar $JAR_FILE &gt; $LOG_FILE 2&gt;&amp;1 &amp;</span><br><span class="line">    </span><br><span class="line">    echo "$SERVICE is running, logs are being written to $LOG_FILE"</span><br><span class="line">  else</span><br><span class="line">    echo "Jar file for $SERVICE not found."</span><br><span class="line">  fi</span><br><span class="line">done</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<h3 id="配置Aliyun的maven镜像源（Docker版）"><a href="#配置Aliyun的maven镜像源（Docker版）" class="headerlink" title="配置Aliyun的maven镜像源（Docker版）"></a>配置 Aliyun 的 maven 镜像源（Docker 版）</h3><p><strong>PS：非 Docker 安装如果没有配置 aliyun 仓库地址，把下面的仓库地址加入到 maven 的 conf 目录下的 settings 的 mirrors 标签内即可。</strong></p>
<p>因为 Docker 的 maven 还没配置 aliyun 仓库地址，并且是第一次使用 maven，会在 jenkins_home 下生成一个 tools 文件夹，我们可以到挂载的 data 文件夹下查看，这里我们需要在 maven 内加入 aliyun 的仓库地址，具体路径为<strong>你挂载的路径 /tools/hudson.tasks.Maven_MavenInstallation/Maven-3.9.1/conf</strong></p>
<p>修改 <code>settings.xml</code> 文件夹，将 aliyun 的仓库地址配置到 <strong>mirrors</strong> 标签内</p>
<figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span>&gt;</span>alimaven<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun maven<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://maven.aliyun.com/nexus/content/groups/public/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<h2 id="结果测试"><a href="#结果测试" class="headerlink" title="结果测试"></a>结果测试</h2><h3 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h3><p>以 boot 项目举例，打包完成后我们可以在挂载目录中看到项目的日志输出，那我们要如何访问到项目呢？</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/%E6%95%99%E5%AD%A6%E7%9B%AE%E5%BD%95/202403131329849.png" alt="image-20240313132900782" style="zoom:50%;">

<p>因为我们启动 jenkins 容器时只指定了 Jenkins 的端口并没有把 Jenkins 内部的项目端口暴露出来，所以我们需要删除 Jenkins 容器，再次创建，这次加上我们的项目端口，注意因为我们删除的只是容器，挂载的 data 文件夹并没有删除，所以 Jenkins 的数据缓存还会留在我们宿主机上，当我们再次安装 Jenkins 时，历史数据都还在，所以千万注意不要删除挂载的目录！！</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">删除容器</span></span><br><span class="line">docker rm -rf 容器id/容器名</span><br></pre></td></tr></tbody></table></figure>

<p>修改我们的安装脚本，这次多暴露一个项目的端口 1234</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">-p 8081:8080 \</span><br><span class="line">-p 1234:1234 \</span><br><span class="line">-u 0 \</span><br><span class="line">-v /Users/sora33/docker/jenkins/data:/var/jenkins_home \</span><br><span class="line">--restart=always \</span><br><span class="line">--name jenkins \</span><br><span class="line">jenkins/jenkins:2.448-jdk17</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">再次启动安装脚本</span></span><br><span class="line">./startJenkins.sh</span><br></pre></td></tr></tbody></table></figure>

<p>通过查看 1234 端口，可以发现是 docker 在占用</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/%E6%95%99%E5%AD%A6%E7%9B%AE%E5%BD%95/202403131326477.png" alt="image-20240313132628391"></p>
<p>调用接口也可以正常返回</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/%E6%95%99%E5%AD%A6%E7%9B%AE%E5%BD%95/202403131326808.png" alt="image-20240313132645759" style="zoom:67%;">

<h3 id="非Docker"><a href="#非Docker" class="headerlink" title="非Docker"></a>非 Docker</h3><p>如果我们直接在宿主机部署项目，那么我们直接访问接口就可以。</p>
<p>直接放个日志图，项目启动成功并且接口也成功访问到</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/%E6%95%99%E5%AD%A6%E7%9B%AE%E5%BD%95/202403131335514.png" alt="image-20240313133515417"></p>
<h2 id="结束语"><a href="#结束语" class="headerlink" title="结束语"></a>结束语</h2><p>Jenkins 的初步用法到这里就结束了，当然 Jenkins 也还有非常多的用法，大家也可以摸索一下，如果在搭建过程中遇到问题也欢迎留言，如果觉得有用可以分享给他人～</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://33sora.com/">Sora33</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://33sora.com/posts/e7a56fe2.html">http://33sora.com/posts/e7a56fe2.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://33sora.com" target="_blank">Sora33</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/jenkis/">jenkis</a><a class="post-meta__tags" href="/tags/DevOps/">DevOps</a></div><div class="post-share"><div class="social-share" data-image="https://minaseinori.oss-cn-hongkong.aliyuncs.com/blog/0401/wallhaven-3l3ed3_3840x2160.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>赞助</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/wechat.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/alipay.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/4a355187.html" title="【从零开始的 K8s-02】ingress-nginx 的认识与使用"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/blog/0817/wallhaven-57erm8_1920x1080.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">【从零开始的 K8s-02】ingress-nginx 的认识与使用</div></div><div class="info-2"><div class="info-item-1">认识 Ingress-nginx我们先来看一下官网对于 ingress 的解释：  Ingress 提供从集群外部到集群内服务的 HTTP 和 HTTPS 路由。流量路由由 Ingress 资源所定义的规则来控制。下面是 Ingress 的一个简单示例，可将所有流量都发送到同一 Service：   通俗的理解，我们可以将 ingress 理解为 cloud 项目里的网关，通过判断请求信息、请求路径后，转发到对应的服务内。 常见的 ingress 控制器有 ingress-nginx、Traefik、HAProxy Ingress 等等，但使用最多的还是 nginx，本文也会以 ingress-nginx 来做演示 PS：ingress-nginx 是 kubernetes 社区维护的，而 kubernetes-ingress 是 nginx 官方维护的，本文使用前者！ minikube安装 Ingress-nginx 控制器运行下面的命令进行安装 1kubectl apply -f...</div></div></div></a><a class="pagination-related" href="/posts/4b0e020.html" title="mybatis-flex 框架的学习与使用"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/blog/0805/0805/wallhaven-rdv5q7_3840x2160.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">mybatis-flex 框架的学习与使用</div></div><div class="info-2"><div class="info-item-1">前言最近发现了这个新框架，想着学习一下发现网上的教程几乎全是对官网的复制粘贴…… 很多细节要点都没有告诉你，很容易让人看的一头雾水，所以自己跟着官网文档做了一个示例 Demo，写个教程做记录，也分享给需要的各位（后面会使用 flex 指代 mybatis-flex、plus 指代 mybatis-plus） 常见问题这里我把常见问题放在前面是因为有很多坑，所以我想先把我踩过的坑列出来，提前了解，不然后面问题很多不好解释。这些坑我也都是从官网找的对应解决方法，在这里放出来同时加深一下印象。 如何使用分页 以前我们 mybatis-plus 会搭配 pagehelper-spring-boot-starter 依赖来实现分页，但是使用 mybatis-flex 后，请注意，将分页依赖更换为 pagehelper 依赖 原因是 pagehelper-spring-boot-starter 依赖的 mybatis-spring-boot-starter 会使 flex 启动异常，导致查询时参数赋值不上，会产生《No value specified for parameter...</div></div></div></a></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/blog/nayuta.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Sora33</div><div class="author-info-description">未来无限可能</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">61</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">65</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><div class="card-info-social-icons"><a class="social-icon" href="http://wpa.qq.com/msgrd?v=3&amp;uin=2097665736&amp;site=qq&amp;menu=yes" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="/img/sora33QR.jpg" target="_blank" title="VX"><i class="fab fa-weixin"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">Java/自宅警备员/nayuta单推人<br>本站主要记录自己自学的一些技术,欢迎各位一起留言讨论。</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E8%AF%B4%E6%98%8E"><span class="toc-number">2.</span> <span class="toc-text">环境说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85Jenkins%EF%BC%88Docker%EF%BC%89"><span class="toc-number">3.</span> <span class="toc-text">安装 Jenkins（Docker）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%89%E5%8F%96%E9%95%9C%E5%83%8F"><span class="toc-number">3.1.</span> <span class="toc-text">拉取镜像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E5%AE%89%E8%A3%85%E8%84%9A%E6%9C%AC"><span class="toc-number">3.2.</span> <span class="toc-text">编写安装脚本</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85Jenkins%EF%BC%88%E9%9D%9EDocker%EF%BC%89"><span class="toc-number">4.</span> <span class="toc-text">安装 Jenkins（非 Docker）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Mac%E5%B9%B3%E5%8F%B0%EF%BC%9A"><span class="toc-number">4.1.</span> <span class="toc-text">Mac 平台：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Linux%E5%B9%B3%E5%8F%B0%EF%BC%9A"><span class="toc-number">4.2.</span> <span class="toc-text">Linux 平台：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Jenkins%E9%85%8D%E7%BD%AE"><span class="toc-number">5.</span> <span class="toc-text">Jenkins 配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6"><span class="toc-number">5.1.</span> <span class="toc-text">安装插件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7"><span class="toc-number">5.2.</span> <span class="toc-text">创建用户</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEMaven"><span class="toc-number">5.3.</span> <span class="toc-text">配置 Maven</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Docker%E7%89%88%E9%85%8D%E7%BD%AE"><span class="toc-number">5.3.1.</span> <span class="toc-text">Docker 版配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Linux%E4%B8%8EMac%E9%85%8D%E7%BD%AE"><span class="toc-number">5.3.2.</span> <span class="toc-text">Linux 与 Mac 配置</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEJava"><span class="toc-number">5.4.</span> <span class="toc-text">配置 Java</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Docker%E7%89%88%E9%85%8D%E7%BD%AE-1"><span class="toc-number">5.4.1.</span> <span class="toc-text">Docker 版配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Linux%E4%B8%8EMac%E9%85%8D%E7%BD%AE-1"><span class="toc-number">5.4.2.</span> <span class="toc-text">Linux 与 Mac 配置</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B5%E9%9D%A2%E4%B8%8A%E9%85%8D%E7%BD%AEJenkins%E4%B8%8B%E8%BD%BD%E6%BA%90"><span class="toc-number">5.5.</span> <span class="toc-text">页面上配置 Jenkins 下载源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Jenkins%E7%9A%84%E4%B8%BB%E7%9B%AE%E5%BD%95"><span class="toc-number">5.6.</span> <span class="toc-text">Jenkins 的主目录</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Jenkins%E4%BD%BF%E7%94%A8"><span class="toc-number">6.</span> <span class="toc-text">Jenkins 使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Maven%E9%A1%B9%E7%9B%AE%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9E%84%E5%BB%BA"><span class="toc-number">6.1.</span> <span class="toc-text">Maven 项目自动化构建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#boot%E9%A1%B9%E7%9B%AE%E9%80%9A%E7%94%A8shell%E8%84%9A%E6%9C%AC"><span class="toc-number">6.2.</span> <span class="toc-text">boot 项目通用 shell 脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cloud%E9%A1%B9%E7%9B%AE%E9%80%9A%E7%94%A8shell%E8%84%9A%E6%9C%AC"><span class="toc-number">6.3.</span> <span class="toc-text">cloud 项目通用 shell 脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEAliyun%E7%9A%84maven%E9%95%9C%E5%83%8F%E6%BA%90%EF%BC%88Docker%E7%89%88%EF%BC%89"><span class="toc-number">6.4.</span> <span class="toc-text">配置 Aliyun 的 maven 镜像源（Docker 版）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E6%9E%9C%E6%B5%8B%E8%AF%95"><span class="toc-number">7.</span> <span class="toc-text">结果测试</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Docker"><span class="toc-number">7.1.</span> <span class="toc-text">Docker</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%9EDocker"><span class="toc-number">7.2.</span> <span class="toc-text">非 Docker</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E6%9D%9F%E8%AF%AD"><span class="toc-number">8.</span> <span class="toc-text">结束语</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/89e44969.html" title="hexo &amp; butterfly 升级与注意要点"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/blog/0817/wallhaven-57erm8_1920x1080.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="hexo &amp; butterfly 升级与注意要点"/></a><div class="content"><a class="title" href="/posts/89e44969.html" title="hexo &amp; butterfly 升级与注意要点">hexo &amp; butterfly 升级与注意要点</a><time datetime="2024-12-09T07:10:21.000Z" title="发表于 2024-12-09 15:10:21">2024-12-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/41ed1960.html" title="基于 ollama 从零部署大语言模型"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/blog/wallhaven-l35j32_1920x1080.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="基于 ollama 从零部署大语言模型"/></a><div class="content"><a class="title" href="/posts/41ed1960.html" title="基于 ollama 从零部署大语言模型">基于 ollama 从零部署大语言模型</a><time datetime="2024-09-27T05:33:47.000Z" title="发表于 2024-09-27 13:33:47">2024-09-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/ef6e6a13.html" title="个人对设计模式的理解与实践 (持续缓更)"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/blog/0805/0805/wallhaven-rdv5q7_3840x2160.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="个人对设计模式的理解与实践 (持续缓更)"/></a><div class="content"><a class="title" href="/posts/ef6e6a13.html" title="个人对设计模式的理解与实践 (持续缓更)">个人对设计模式的理解与实践 (持续缓更)</a><time datetime="2024-09-10T05:24:04.000Z" title="发表于 2024-09-10 13:24:04">2024-09-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/144a2659.html" title="Java21 虚拟线程的研究与使用"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/blog/0805/0805/wallhaven-6d2l9q_3840x2160.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Java21 虚拟线程的研究与使用"/></a><div class="content"><a class="title" href="/posts/144a2659.html" title="Java21 虚拟线程的研究与使用">Java21 虚拟线程的研究与使用</a><time datetime="2024-08-13T01:49:33.000Z" title="发表于 2024-08-13 09:49:33">2024-08-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/8cfd5cf5.html" title="gRPC 框架的学习和使用"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://minaseinori.oss-cn-hongkong.aliyuncs.com/blog/0817/wallhaven-dprlej_1920x1080.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="gRPC 框架的学习和使用"/></a><div class="content"><a class="title" href="/posts/8cfd5cf5.html" title="gRPC 框架的学习和使用">gRPC 框架的学习和使用</a><time datetime="2024-07-17T07:49:46.000Z" title="发表于 2024-07-17 15:49:46">2024-07-17</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(https://minaseinori.oss-cn-hongkong.aliyuncs.com/blog/0401/wallhaven-3l3ed3_3840x2160.png);"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2024 By Sora33</div><div class="footer_custom_text"><a target="_blank" rel="noopener" href="http://beian.miit.gov.cn"><span>晋ICP备2022007182号</span></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="fa-solid fa-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="fa-solid fa-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="fa-solid fa-arrow-rotate-right"></i></div><div class="rightMenu-item" id="menu-home"><i class="fa-solid fa-house"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" href="/archives/"><i class="fa-solid fa-archive"></i><span>文章归档</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="fa-solid fa-folder-open"></i><span>文章分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="fa-solid fa-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuNormal"><a class="rightMenu-item menu-link" id="menu-radompage" href="/index.html"><i class="fa-solid fa-shoe-prints"></i><span>随便逛逛</span></a><div class="rightMenu-item" id="menu-translate"><i class="fa-solid fa-earth-asia"></i><span>繁简切换</span></div><div class="rightMenu-item" id="menu-darkmode"><i class="fa-solid fa-moon"></i><span>切换模式</span></div></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.isShuoshuo
  const option = null

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://sprightly-liger-8d5ebf.netlify.app/.netlify/functions/twikoo',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = (el = document, path = location.pathname) => {
    twikoo.init({
      el: el.querySelector('#twikoo-wrap'),
      envId: 'https://sprightly-liger-8d5ebf.netlify.app/.netlify/functions/twikoo',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      },
      ...option,
      path: isShuoshuo ? path : (option && option.path) || path
    })

    

    isShuoshuo && (window.shuoshuoComment.destroyTwikoo = () => {
      if (el.children.length) {
        el.innerHTML = ''
        el.classList.add('no-comment')
      }
    })
  }

  const loadTwikoo = (el, path) => {
    if (typeof twikoo === 'object') setTimeout(() => init(el, path), 0)
    else btf.getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(() => init(el, path))
  }

  if (isShuoshuo) {
    'Twikoo' === 'Twikoo'
      ? window.shuoshuoComment = { loadComment: loadTwikoo }
      : window.loadOtherComment = loadTwikoo
    return
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><script defer src="https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js"></script><script defer data-pjax src="/js/rightMenu.js"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/algoliasearch/dist/lite/builds/browser.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script></div></div></body></html>